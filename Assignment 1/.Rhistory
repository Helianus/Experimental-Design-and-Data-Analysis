samples = 1000
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 1000
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 1000
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 1000
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 1000
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
View(Rho_MC)
r_obs = 0.3
n = 10
samples = 10
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 10
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 10
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 10
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 10
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 10
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 10
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 10
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 100000000
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 100000000
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 100000
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
r_obs = 0.3
n = 10
samples = 1000
Rho_MC = matrix(0,samples)
for (i in 1:samples) {
S = rnorm(n)
A = rnorm(n)
Rho_MC[i] = cor(A,S)
}
pval = length(which(Rho_MC > r_obs))/samples
knitr::opts_chunk$set(echo = TRUE)
library(colorspace)
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(knitr)
library(ggplot2)
library(colorspace)
library(Matrix) # for sparse matrix
library(nnet) # for which.is.max
#bandit_rates <- c(0.1, 0.5, 0.6, 0.8, 0.3, 0.25, 0.6, 0.45, 0.75, 0.65)
bandit_rates <- round(runif(n = 10, 5, 20), 2)
n_bandits <- length(bandit_rates)
bandit_rates
library(data.table)
library(knitr)
library(ggplot2)
library(colorspace)
library(Matrix) # for sparse matrix
library(nnet) # for which.is.max
#bandit_rates <- c(0.1, 0.5, 0.6, 0.8, 0.3, 0.25, 0.6, 0.45, 0.75, 0.65)
bandit_rates <- round(runif(n = 10, 5, 20), 2)
n_bandits <- length(bandit_rates)
bandit_rates
library(data.table)
library(knitr)
library(ggplot2)
library(colorspace)
library(Matrix) # for sparse matrix
library(nnet) # for which.is.max
#bandit_rates <- c(0.1, 0.5, 0.6, 0.8, 0.3, 0.25, 0.6, 0.45, 0.75, 0.65)
bandit_rates <- round(runif(n = 10, 5, 20), 2)
n_bandits <- length(bandit_rates)
bandit_rates
random <- function(actions, rewards, episode, n_episodes)
{
a <- sample(seq(n_bandits), nrow(actions), replace = T)
return(a)
}
experiments <- list( "Random Baseline" = random,
"Greedy (w default Laplace smoothing)" = greedy,
"Epsilon Greedy" = epsilon_greedy,
# "Greedy breaking ties at random" = greedy_tie_breaker,
# "Decayed Espsilion Greedy" = decayed_epsilon_greedy,
#"Propensity Smoothing" = propensity_smoothing,
#"Roulette Wheel" = roulette_wheel,
#"Thompson Sampling" = thompson_sampling,
"Upper Confidence Bounds (UCB1)" = ucb1)
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(knitr)
library(ggplot2)
library(colorspace)
library(Matrix) # for sparse matrix
library(nnet) # for which.is.max
#bandit_rates <- c(0.1, 0.5, 0.6, 0.8, 0.3, 0.25, 0.6, 0.45, 0.75, 0.65)
bandit_rates <- round(runif(n = 10, 5, 20), 2)
n_bandits <- length(bandit_rates)
bandit_rates
random <- function(actions, rewards, episode, n_episodes)
{
a <- sample(seq(n_bandits), nrow(actions), replace = T)
return(a)
}
greedy <- function(actions, rewards, episode, n_episodes)
{
successrates <- (0.5+rewards)/(1+actions)
a <- apply(successrates, 1, which.max)
return(a)
}
greedy_tie_breaker <- function(actions, rewards, episode, n_episodes)
{
successrates <- (0.5+rewards)/(1+actions)
a <- apply(successrates, 1, which.is.max) # which.is.max randomizes between ties
return(a)
}
epsilon_greedy <- function(actions, rewards, episode, n_episodes, epsilon = 0.1)
{
r <- random(actions)
g <- greedy_tie_breaker(actions, rewards)
p <- runif(nrow(actions))
a <- ifelse(p <= epsilon, r, g)
return(a)
}
ucb1 <- function(actions, rewards, episode, n_episodes)
{
successrates <- (0.5+rewards)/(1+actions)
confbound <- t(apply(actions, 1, function(arow) { return (sqrt(2*log(episode+1)/(arow+1e-10))) }))
a <- apply(successrates+confbound, 1, which.max)
return(a)
}
experiments <- list( "Random Baseline" = random,
"Greedy (w default Laplace smoothing)" = greedy,
"Epsilon Greedy" = epsilon_greedy,
# "Greedy breaking ties at random" = greedy_tie_breaker,
# "Decayed Espsilion Greedy" = decayed_epsilon_greedy,
#"Propensity Smoothing" = propensity_smoothing,
#"Roulette Wheel" = roulette_wheel,
#"Thompson Sampling" = thompson_sampling,
"Upper Confidence Bounds (UCB1)" = ucb1)
for (exp in names(experiments))
{
algo <- experiments[[exp]]
experiments[[exp]] <- c("algo" = algo, runExperiments(n_experiments=1000, n_episodes=3000, algo))
propensities <- melt(data.table(experiments[[exp]]$successrates)[, episode := seq(.N) ], id.vars=c("episode"),
variable.name = "bandit", value.name = "propensity")
actions <- melt(data.table(experiments[[exp]]$actions)[, episode := seq(.N) ], id.vars=c("episode"),
variable.name = "bandit", value.name = "frequency")
rewards <- melt(data.table(experiments[[exp]]$rewards)[, episode := seq(.N) ], id.vars=c("episode"),
variable.name = "bandit", value.name = "reward")
plotdata <- merge(propensities, merge(actions, rewards, by=c("episode", "bandit")), by=c("episode", "bandit"))
# show how the propensities of the agents evolve over time
print(ggplot(na.omit(plotdata),
aes(episode, propensity, colour=bandit, size=frequency)) + geom_line() +
ggtitle("Propensities over Time",
subtitle = paste(exp, ", averaged over", experiments[[exp]]$n_experiments, "experiments")))
}
install.packages("contextual")
library(contextual)
horizon = 400
simulations = 1000
click_probabilities <- matrix(c(0.6, 0.4, 0.2), nrow = 1, ncol = 3, byrow = TRUE)
bandit <- ContextualBernoulliBandit$new(weights = click_probabilities)
View(bandit)
View(click_probabilities)
library(contextual)
horizon = 400
simulations = 1000
click_probabilities = round(rnorm(10,5,20),2)
bandit = ContextualBernoulliBandit$new(weights = click_probabilities)
library(contextual)
horizon = 400
simulations = 1000
click_probabilities = matrix(round(rnorm(10,5,20),2))
bandit = ContextualBernoulliBandit$new(weights = click_probabilities)
View(click_probabilities)
library(contextual)
horizon = 400
simulations = 1000
click_probabilities = matrix(round(rnorm(10,5,20),2), norw=1, ncol=10, byrow=TRUE)
library(contextual)
horizon = 400
simulations = 1000
click_probabilities = matrix(round(rnorm(10,5,20),2), nrow=1, ncol=10, byrow=TRUE)
bandit = ContextualBernoulliBandit$new(weights = click_probabilities)
View(click_probabilities)
library(contextual)
horizon = 400
simulations = 1000
click_probabilities = matrix(round(rnorm(10,5,20),3), nrow=1, ncol=10, byrow=TRUE)
bandit = ContextualBernoulliBandit$new(weights = click_probabilities)
View(click_probabilities)
View(click_probabilities)
knitr::opts_chunk$set(echo = TRUE)
library(contextual)
horizon = 400
simulations = 1000
click_probabilities = matrix(round(rnorm(10,5,20),3), nrow=1, ncol=10, byrow=TRUE)
bandit = ContextualBernoulliBandit$new(weights = click_probabilities)
eg_policy <- EpsilonGreedyPolicy$new(epsilon = 0.4)
eg_agent <- Agent$new(eg_policy, bandit)
simulator <- Simulator$new(eg_agent, horizon, simulations, do_parallel = TRUE)
history <- simulator$run()
plot(history, type = "average", regret = FALSE)
plot(history, type = "cumulative", regret = FALSE, rate = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(contextual)
horizon = 1000
simulations = 1000
click_probabilities = matrix(round(rnorm(10,5,20),3), nrow=1, ncol=10, byrow=TRUE)
bandit = ContextualBernoulliBandit$new(weights = click_probabilities)
eg_policy <- EpsilonGreedyPolicy$new(epsilon = 0.4)
eg_agent <- Agent$new(eg_policy, bandit)
simulator <- Simulator$new(eg_agent, horizon, simulations, do_parallel = TRUE)
history <- simulator$run()
plot(history, type = "average", regret = FALSE)
plot(history, type = "cumulative", regret = FALSE, rate = TRUE)
eg_policy <- EpsilonGreedyPolicy$new(epsilon = 0.4)
eg_agent <- Agent$new(eg_policy, bandit)
simulator <- Simulator$new(eg_agent, horizon, simulations)
history <- simulator$run()
plot(history, type = "average", regret = FALSE)
plot(history, type = "cumulative", regret = FALSE, rate = TRUE)
eg_policy <- EpsilonGreedyPolicy$new(epsilon = 0.4)
eg_agent <- Agent$new(eg_policy, bandit)
simulator <- Simulator$new(eg_agent, horizon, simulations)
history <- simulator$run()
plot(history)
eg_policy <- EpsilonGreedyPolicy$new(epsilon = 0.4)
eg_agent <- Agent$new(eg_policy, bandit)
simulator <- Simulator$new(eg_agent, horizon, simulations)
history <- simulator$run()
plot(history, type = "average", regret = FALSE)
plot(history, type = "cumulative", regret = FALSE, rate = TRUE)
eg_policy <- EpsilonGreedyPolicy$new(epsilon = 0.4)
eg_agent <- Agent$new(eg_policy, bandit)
agents = list(eg_agent)
simulator <- Simulator$new(agents, horizon, simulations)
history <- simulator$run()
plot(history, type = "average", regret = FALSE)
plot(history, type = "cumulative", regret = FALSE, rate = TRUE)
eg_policy <- EpsilonGreedyPolicy$new(epsilon = 0.4)
eg_agent <- Agent$new(eg_policy, bandit)
agents = list(eg_agent)
simulator <- Simulator$new(agents, horizon, simulations)
history <- simulator$run()
plot(history, type = "average", regret = FALSE)
legend("bottomright")
eg_policy <- EpsilonGreedyPolicy$new(epsilon = 0.4)
eg_agent <- Agent$new(eg_policy, bandit)
agents = list(eg_agent)
simulator <- Simulator$new(agents, horizon, simulations)
history <- simulator$run()
plot(history, type = "average", regret = FALSE)
plot(history, type = "cumulative", regret = FALSE, rate = TRUE)
View(eg_policy)
View(click_probabilities)
x=rnom(100)
x=rnorm(100)
par(mfrow=c(1,2))
hist(x)
hist(x)}
hist(x)
x=rnorm(100); par(mfrow=c(1,2))
hist(x)
hist(x,prob=T)
x
x=rnorm(100)
hist(x)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
x = 3
x
x==3; x==4
y = c(x,6)
y = c(x,6)
y
x = 3
x
x==3; x==4
y = c(x,6)
y
1:10
seq(0,10,length=40)
1:10
seq(0,10,length=40)
rep(2,5)
rep(1:3,5)
rep(2,5)
rep(1:3,5)
y=c(1.4,1.6,7.5,3.1,9.5,1.0,3.8,2)
length(y)
y[2]
y[c(1,4,5)]
y[-1]
y<4
y[y<4]
y[2]
y[c(1,4,5)]
y[-1]
y<4
y[y<4]
y[-2]
y[-3]
y[0]
y[-5]
matrix(1:6,nrow=2)
matrix(1:6,ncol=3)
matrix(1:6,nrow=2)
matrix(1:6,ncol=3)
M=matrix(1:6,ncol=3,byrow=TRUE)
M
dim(M);nrow(M);ncol(M)
M[2,3]; M[,3]; M[2,]; M[1,1:2]
M[2,3]; M[,3]; M[2,]; M[1,1:2]; M[1, 1:3]
M[2,3]; M[,3]; M[2,]; M[1,1:2]; M[1,1:3]; M[1,2:3]
t(M); A+B; A-B; A%*%B
t(M)
A=matrix(1:8,ncol=4,byrow=TRUE)
A
B=matrix(2:10,nrow=4,bycol=TRUE)
A=matrix(1:8,ncol=4,byrow=TRUE)
A
B=matrix(2:10,nrow=4,byrow=TRUE)
B
A=matrix(1:8,ncol=4,byrow=TRUE)
A
B=matrix(2:10,ncol=4,byrow=TRUE)
B
A=matrix(1:8,ncol=4,byrow=TRUE)
A
B=matrix(1:8,nrow=4,byrow=TRUE)
B
A+B
Bt = t(B)
A+B
Bt = t(B)
A+Bt
A-Bt
A%*%Bt
Bt = t(B)
Bt
A+Bt
A-Bt
A%*%Bt
Bt = t(B)
Bt
Bt = t(B)
Bt
A+Bt
A-Bt
A%*%Bt
A+Bt
A-Bt
A%*%B
t(M)
det(M)
t(M)
det(M)
t(M)
C=matrix(1:4,ncol=2,byrow=TRUE)
C
det(C)
solve(C)
help(boxplot); boxplot(y)
z=c(2.7,4.3,9.5,1.4,5.5,7.2); boxplot(y,z)
x=seq(0,10,length=30);x
y=sin(x);y
plot(x,sin(x))
plot(x,sin(x),type="l",xlab="x",ylab="sin(x)")
setwd("~/")
setwd("~/")
setwd("C:/Users/Helia/OneDrive/VU-Cources/Experimental-Design-And-Data-Analysis/assignments/Experimental-Design-and-Data-Analysis/Assignment 1")
knitr::opts_chunk$set(echo = TRUE)
data = read.table(file="birthweight.txt", header=TRUE)
qqnorm(data$birthweight)
data_mean = mean(data$birthweight)
error = qt(0.95, df=length(data$birthweight)) * sd(data$birthweight) / sqrt(length(data$birthweight))
upper_bound = data_mean + error
lower_bound = data_mean - error
t.test(data$birthweight, conf.level=0.9)
t.test(data$birthweight, mu=2800, alternative="greater")
unlink('assignment01_group43_cache', recursive = TRUE)
